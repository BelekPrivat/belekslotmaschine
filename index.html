<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8">
<title>ğŸ° BelekÂ´s Slot-Maschine</title>

<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>

<style>
html,body{margin:0;padding:0;height:100%;background:#111;color:white;font-family:Arial}
#layout{display:flex;height:100vh;overflow:hidden}
#app{width:55%;display:flex;flex-direction:column;align-items:center;justify-content:center}

h1{color:gold;font-size:2.6rem}
.status{color:cyan}
.jackpot{color:gold;font-size:1.9rem;text-shadow:0 0 10px gold}

.reels{display:flex;gap:25px;margin:15px}
.reel{width:95px;font-size:4.5rem;background:#000;padding:18px;border:5px ridge gold;text-align:center}

.controls button{padding:10px 16px;margin:4px;font-size:1.05rem}
.spin{background:green;color:white}
.allin{background:red;color:white}
.modbtn{background:#444;color:gold}

.player-info{font-size:1.25rem;color:cyan;margin-top:8px}

#right{
 width:45%;
 background:black;
 border-left:4px solid gold;
 padding:12px;
 display:flex;
 flex-direction:column;
 gap:12px;
 overflow:hidden
}

.panel{
 background:linear-gradient(180deg,#111,#000);
 border:2px solid gold;
 border-radius:12px;
 padding:10px;
 display:flex;
 flex-direction:column;
 overflow:hidden
}

.panel h3{text-align:center;color:gold;margin:6px 0}

#leaderboardList,#winLog{
 overflow-y:auto;
 overflow-x:hidden
}

#leaderboardList{min-height:450px;max-height:450px}
#winLog{min-height:320px;max-height:320px}

#leaderboardList div{
 display:flex;
 justify-content:space-between;
 padding:6px;
 border-bottom:1px solid #333
}

.lb-1{color:gold}
.lb-2{color:silver}
.lb-3{color:#cd7f32}
.lb-self{border-left:3px solid cyan}

.log-entry{font-weight:bold}
.log-win{color:#00ff7f}
.log-lose{color:#ff4c4c}
.log-jackpot{color:gold}

/* ===== MOD MENU ===== */
#modOverlay{
 position:fixed;
 inset:0;
 background:rgba(0,0,0,.85);
 display:none;
 justify-content:center;
 align-items:center;
 z-index:9999
}

#modMenu{
 background:#111;
 border:3px solid gold;
 border-radius:15px;
 padding:20px;
 width:340px;
 text-align:center
}

#modMenu input,#modMenu button{
 width:100%;
 margin:6px 0;
 padding:8px;
 font-size:1rem
}

#modMenu button{background:#222;color:gold;border:1px solid gold}
</style>
</head>

<body>

<div id="layout">

<div id="app">
<h1>ğŸ° BelekÂ´s Slot-Maschine</h1>
<div id="status" class="status"></div>
<div id="jackpot" class="jackpot"></div>
<div id="timer" class="status"></div>

<div class="reels">
<div class="reel" id="r1">â”</div>
<div class="reel" id="r2">â”</div>
<div class="reel" id="r3">â”</div>
</div>

<div class="controls">
<button onclick="setBet()">ğŸ¯ Einsatz</button>
<button class="allin" onclick="allIn()">ğŸ’¥ ALL IN</button>
<button class="spin" onclick="spin()">â–¶ SPIN</button>
<button class="modbtn" onclick="openMod()">ğŸ›  MOD</button>
</div>

<div id="playerInfo" class="player-info"></div>
</div>

<div id="right">
<div class="panel"><h3>ğŸ† Leaderboard</h3><div id="leaderboardList"></div></div>
<div class="panel"><h3>ğŸ§¾ Gewinne</h3><div id="winLog"></div></div>
</div>
</div>

<!-- MOD MENU -->
<div id="modOverlay">
<div id="modMenu">
<h3>ğŸ›  MOD MENÃœ</h3>
<input id="modPass" type="password" placeholder="Passwort">
<button onclick="loginMod()">Login</button>

<div id="modActions" style="display:none">
<button onclick="resetGame()">ğŸ”„ Spiel resetten</button>
<button onclick="setJackpot()">ğŸ’ Jackpot setzen</button>
<button onclick="setMoney()">ğŸ’° Geld geben/nehmen</button>
<button onclick="closeMod()">âŒ SchlieÃŸen</button>
</div>
</div>
</div>

<script>
/* ===== FIREBASE ===== */
firebase.initializeApp({
 apiKey:"AIzaSyBqJub5JZstuXNlemSLc9HFziEs11gA70k",
 authDomain:"slot-site-dce13.firebaseapp.com",
 projectId:"slot-site-dce13"
});

const db=firebase.firestore();
const jackpotRef=db.collection("game").doc("jackpot");

/* ===== CONFIG ===== */
const MOD_PASSWORD="admin123";
const SYMBOLS=["ğŸ’","ğŸ‹","ğŸŠ","ğŸ””","â­","7ï¸âƒ£","ğŸ’"];
const PAYTABLE={"ğŸ’":5,"ğŸ‹":7,"ğŸŠ":10,"ğŸ””":15,"â­":25,"7ï¸âƒ£":50};

let playerName=localStorage.getItem("player_name")||prompt("Spielername:");
localStorage.setItem("player_name",playerName);

let data={balance:5000,bet:50,lastIncome:Date.now()};
let jackpotValue=5000;
let spinning=false;
let winLog=[];

/* ===== MOD MENU ===== */
function openMod(){modOverlay.style.display="flex"}
function closeMod(){modOverlay.style.display="none"}

function loginMod(){
 if(modPass.value===MOD_PASSWORD){
  modActions.style.display="block";
  modPass.style.display="none";
 }else alert("Falsches Passwort");
}

async function resetGame(){
 if(!confirm("ALLES resetten?")) return;
 const players=await db.collection("players").get();
 players.forEach(d=>d.ref.delete());
 jackpotValue=5000;
 await jackpotRef.set({value:5000});
 alert("Reset abgeschlossen");
}

async function setJackpot(){
 const v=parseInt(prompt("Neuer Jackpot:"));
 if(!isNaN(v)){
  jackpotValue=v;
  await jackpotRef.set({value:v});
 }
}

async function setMoney(){
 const target=prompt("Spielername:");
 const amount=parseInt(prompt("Betrag (+/-):"));
 if(!target||isNaN(amount)) return;
 const ref=db.collection("players").doc(target);
 const doc=await ref.get();
 if(doc.exists){
  ref.update({balance:doc.data().balance+amount});
 }
}

/* ===== GAME ===== */
function randomSym(){return SYMBOLS[Math.floor(Math.random()*SYMBOLS.length)]}

async function spin(){
 if(spinning||data.balance<data.bet) return;
 spinning=true;
 data.balance-=data.bet;
 jackpotValue+=data.bet;
 await jackpotRef.set({value:jackpotValue});

 const f1=randomSym(),f2=randomSym(),f3=randomSym();
 animate(r1,f1,600);animate(r2,f2,800);animate(r3,f3,1000);

 setTimeout(async()=>{
  if(f1===f2&&f2===f3){
   if(f1==="ğŸ’"){
    data.balance+=jackpotValue;
    log(`ğŸ’ JACKPOT +${jackpotValue}â‚¬`,"jackpot");
    jackpotValue=5000;
    await jackpotRef.set({value:5000});
   }else{
    const win=data.bet*PAYTABLE[f1];
    data.balance+=win;
    log(`ğŸ‰ ${f1}${f2}${f3} +${win}â‚¬`,"win");
   }
  }else log("âŒ Kein Gewinn","lose");

  await db.collection("players").doc(playerName).set(data,{merge:true});
  updateUI();
  spinning=false;
 },1100);
}

function animate(r,f,d){
 const s=Date.now();
 const i=setInterval(()=>{
  r.innerText=randomSym();
  if(Date.now()-s>=d){clearInterval(i);r.innerText=f}
 },70);
}

function log(t,type){
 const c="log-entry "+(type==="win"?"log-win":type==="lose"?"log-lose":"log-jackpot");
 winLog.unshift(`<div class="${c}">${t}</div>`);
 winLog=winLog.slice(0,12);
 winLogEl.innerHTML=winLog.join("");
}

function updateUI(){
 status.innerText=`ğŸ‘¤ ${playerName}`;
 jackpot.innerText=`ğŸ’ JACKPOT: ${jackpotValue} â‚¬`;
 playerInfo.innerText=`ğŸ’° ${data.balance} â‚¬ | ğŸ¯ Einsatz ${data.bet} â‚¬`;
}

function setBet(){
 const v=parseInt(prompt("Einsatz:",data.bet));
 if(v>=50&&v<=data.balance) data.bet=v;
 updateUI();
}
function allIn(){data.bet=data.balance;updateUI()}

/* ===== INIT ===== */
jackpotRef.onSnapshot(d=>{if(d.exists){jackpotValue=d.data().value;updateUI()}});
db.collection("players").doc(playerName).get().then(d=>{
 if(d.exists) data={...data,...d.data()};
 else db.collection("players").doc(playerName).set(data);
 updateUI();
});
</script>
</body>
</html>


