<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8">
<title>ğŸ° BelekÂ´s Slot-Maschine</title>

<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>

<style>
html,body{margin:0;height:100%;background:#111;color:white;font-family:Arial}
#layout{display:flex;height:100vh;overflow:hidden}

/* SPIEL */
#app{width:55%;display:flex;flex-direction:column;align-items:center;justify-content:center}
h1{color:gold}
.status{color:cyan}
.jackpot{color:gold;font-size:1.8rem;text-shadow:0 0 10px gold}
.reels{display:flex;gap:25px;margin:15px}
.reel{width:95px;font-size:4.5rem;background:#000;border:5px ridge gold;text-align:center}
.controls button{padding:10px 16px;margin:4px}
.spin{background:green;color:white}
.allin{background:red;color:white}

/* RECHTS */
#right{width:45%;border-left:4px solid gold;display:flex;flex-direction:column;overflow:hidden}
.scroll{overflow-y:auto;padding:10px;display:flex;flex-direction:column;gap:12px}

.panel{border:2px solid gold;border-radius:12px;padding:8px;background:#000}
.panel h3{text-align:center;color:gold;margin:6px 0}

#leaderboardList,#winLog{max-height:300px;overflow-y:auto}
#leaderboardList div{display:flex;justify-content:space-between;border-bottom:1px solid #333;padding:4px}
.lb-1{color:gold}.lb-2{color:silver}.lb-3{color:#cd7f32}.lb-self{border-left:3px solid cyan}

/* MOD MENU */
#modMenu{display:none;border:2px dashed red}
#modMenu button{width:100%;margin:4px 0;background:#222;color:red}
</style>
</head>

<body>
<div id="layout">

<div id="app">
<h1>ğŸ° BelekÂ´s Slot</h1>
<div id="status" class="status"></div>
<div id="jackpot" class="jackpot"></div>
<div id="timer" class="status"></div>

<div class="reels">
<div class="reel" id="r1">â”</div>
<div class="reel" id="r2">â”</div>
<div class="reel" id="r3">â”</div>
</div>

<div class="controls">
<button onclick="setBet()">ğŸ¯ Einsatz</button>
<button class="allin" onclick="allIn()">ğŸ’¥ ALL IN</button>
<button class="spin" onclick="spin()">â–¶ SPIN</button>
</div>

<div id="playerInfo"></div>
</div>

<div id="right">
<div class="scroll">

<div class="panel">
<h3>ğŸ† Leaderboard</h3>
<div id="leaderboardList"></div>
</div>

<div class="panel">
<h3>ğŸ§¾ Gewinne</h3>
<div id="winLog"></div>
</div>

<div class="panel" id="modMenu">
<h3>ğŸ›  MOD</h3>
<button onclick="resetGame()">Reset Game</button>
<button onclick="setJackpotPrompt()">Set Jackpot</button>
</div>

</div>
</div>

</div>

<script>
firebase.initializeApp({
 apiKey:"AIzaSyBqJub5JZstuXNlemSLc9HFziEs11gA70k",
 authDomain:"slot-site-dce13.firebaseapp.com",
 projectId:"slot-site-dce13"
});
const db=firebase.firestore();

const SYMBOLS=["ğŸ’","ğŸ‹","ğŸŠ","ğŸ””","â­","7ï¸âƒ£","ğŸ’"];
const PAYTABLE={"ğŸ’":5,"ğŸ‹":7,"ğŸŠ":10,"ğŸ””":15,"â­":25,"7ï¸âƒ£":50};

let playerName=localStorage.getItem("player")||prompt("Name?");
localStorage.setItem("player",playerName);

let data={balance:5000,bet:50,lastIncome:Date.now()};
let spinning=false;
let winLog=[];

async function loadPlayer(){
 const ref=db.collection("players").doc(playerName);
 const d=await ref.get();
 if(d.exists) data={...data,...d.data()};
 await ref.set(data,{merge:true});
 updateUI();
}

function updateUI(){
 status.innerText=`ğŸ‘¤ ${playerName}`;
 playerInfo.innerText=`ğŸ’° ${data.balance} â‚¬ | ğŸ¯ ${data.bet} â‚¬`;
}

function log(t){
 winLog.unshift(`<div>${t}</div>`);
 winLog=winLog.slice(0,12);
 winLogEl.innerHTML=winLog.join("");
}

async function spin(){
 if(spinning||data.balance<data.bet) return;
 spinning=true;
 data.balance-=data.bet;

 const f=[rnd(),rnd(),rnd()];
 animate(r1,f[0],600);animate(r2,f[1],800);animate(r3,f[2],1000);

 setTimeout(async()=>{
  if(f[0]==f[1]&&f[1]==f[2]){
   const w=f[0]=="ğŸ’"?1000:data.bet*PAYTABLE[f[0]];
   data.balance+=w;
   log(`ğŸ‰ +${w}â‚¬`);
  } else log("âŒ Verlust");

  await db.collection("players").doc(playerName).set(data,{merge:true});
  updateUI();
  spinning=false;
 },1100);
}

function rnd(){return SYMBOLS[Math.floor(Math.random()*SYMBOLS.length)]}
function animate(r,f,d){
 const s=Date.now();const i=setInterval(()=>{
 r.innerText=rnd();
 if(Date.now()-s>d){clearInterval(i);r.innerText=f}
 },70);
}

function setBet(){const v=+prompt("Einsatz");if(v>0&&v<=data.balance)data.bet=v}
function allIn(){data.bet=data.balance}

/* MOD MENU (Frontend Placeholder) */
if(prompt("Mod Passwort?")==="ADMIN123") modMenu.style.display="block";

function resetGame(){
 if(confirm("Reset?")){
  db.collection("players").get().then(s=>s.forEach(d=>d.ref.delete()));
 }
}

function setJackpotPrompt(){
 const v=+prompt("Jackpot?");
 db.collection("game").doc("jackpot").set({value:v});
}

loadPlayer();
</script>
</body>
</html>
